class Oxford::Surgery < Oxford::Oxford

	EXCLUSIONS = ["part","chapter","introduction"]

	def topics
		["Duties of a doctor","Communication skills","Critical appraisal","Audit","Consent","Death","Clinical governance","Terminology in surgery","History taking and making notes","Common surgical symptoms","Evaluation of breast disease","Evaluation of the neck","Evaluation of the abdomen","Abdominal investigations","Evaluation of pelvic disease","Evaluation of peripheral vascular disease","Evaluation of the skin and subcutaneous tissue disease","Surgery at the extremes of age","Day case and minimally invasive surgery","Surgery in pregnancy","Surgery and the contraceptive pill","Surgery in endocrine disease","Surgery and heart disease","Surgery and respiratory disease","Surgery in renal and hepatic disease","Surgery in neurological disease","Fluid optimization","Nutrition in surgical patients","Enhanced recovery after surgery","Getting the patient to theatre","Prophylaxisantibiotics and thromboprophylaxis","Positioning the patient","Scrubbing up","Surgical instruments","Incisions and closures","Drains","Stomas","Knots and sutures","Drain management","Fluid management","Acidbase balance","Blood products and procoagulants","Transfusion reactions","Shock","Wound emergencies","Cardiac complications","Respiratory complications","Renal complications","Urinary complications","Gastrointestinal complications","Neurological complications","Haematological complications","Deep venous thrombosis and pulmonary embolism","Risk scoring","Critical care","Commonly used terms in ITU","Invasive monitoring","Ventilation and respiratory support","Circulatory support","Renal support","Enteral support","Cellular injury","Inammation","Wound healing","Ulcers","Atherosclerosis","Thromboembolic disease","Gangrene and capillary ischaemia","Tumours","Carcinogenesis","Screening","Grading and staging","Tumour markers","Surgical microbiology","Surgically important organisms","Soft tissue infections","Bleeding and coagulation","Anaemia and polycythaemia","Endotracheal intubation","Cardioversion","Debrillation","Venepuncture","Intravenous cannulation","Arterial puncture and lines","Insertion of central venous catheter","Chest drain insertion","Management of chest drains","Pericardiocentesis","Cricothyroidotomy","Nasogastric tube insertion","Urethral catheterization","Suprapubic catheterization","Paracentesis abdominis","Rigid sigmoidoscopy","Local anaesthesia","Intercostal nerve block","Salivary calculi","Acute parotitis","Salivary gland tumours","Head and neck cancer","Facial trauma","Neck space infections","Breast cancer","Surgical treatment of breast cancer","Breast cancer screening","Benign breast disease","Acute breast pain","Goitre","Thyrotoxicosis","Thyroid tumourstypes and features","Thyroid tumoursdiagnosis and treatment","Primary hyperparathyroidism","Multiple endocrine neoplasia","Cushings syndrome","Conns syndrome","Phaeochromocytoma","Upper gastrointestinal endoscopy","Oesophageal motility disorders","Pharyngeal pouch","Hiatus hernia","Oesophageal tumours","Peptic ulcer disease","Gastric tumours","Chronic intestinal ischaemia","Surgery for morbid obesity","Small bowel tumours","Acute haematemesis","Acute upper GI perforation","Acute appendicitis","Acute peritonitis","Acute abdominal pain","Gynaecological causes of lower abdominal pain","Jaundicecauses and diagnosis","Jaundicemanagement","Gall bladder stones","Common bile duct stones","Chronic pancreatitis","Portal hypertension","Cirrhosis of the liver","Pancreatic cancer","Acute variceal haemorrhage","Acute pancreatitis","Abdominal wall hernias","Inguinal hernia","Femoral hernia","Umbilical and epigastric hernias","Incisional hernias","Other types of hernia","Rectus sheath haematoma","Groin disruption","Acute groin swelling","Symptoms and signs in urology","Investigations of urinary tract disease","Urinary tract stones","Obstruction of the ureter","Benign prostatic hyperplasia","Stricture of the urethra","Scrotal swellings","Disorders of the foreskin","Common conditions of the penis","Erectile dysfunction","Adenocarcinoma of the kidney","Transitional cell tumours","Adenocarcinoma of the prostate","Carcinoma of the penis","Testicular tumours","Haematuria","Acute testicular pain","Ulcerative colitis","Crohns disease","Other forms of colitis","Colorectal polyps","Colorectal cancer","Restorative pelvic surgery","Minimally invasive colorectal surgery","Diverticular disease of the colon","Rectal prolapse","Pilonidal sinus disease","Haemorrhoids","Acute anorectal pain","Acute rectal bleeding","Acute severe colitis","Principles of managing paediatric surgical cases","Acute abdominal emergenciesoverview","Oesophageal atresia","Pyloric stenosis","Malrotation and volvulus","Intussusception","Hirschsprungs disease","Rare causes of intestinal obstruction","Abdominal wall defects","Inguinal hernia and scrotal swellings","Other childhood hernias","Undescended testis","Solid tumours of childhood","Neck swellings","The limping child","The child with a fracture","LeggCalvPerthes disease","Motor development","The osteochondritides","Management of major trauma","Thoracic injuries","Abdominal trauma","Vascular injuries","Head injuries","Examination of a joint","Examination of the limbs and trunk","Fracture healing","Reduction and xation of fractures","The skeletal radiograph","Injuries of the phalanges and metacarpals","Wrist injuries","Fractures of the distal radius and ulna","Fractures of the radius and ulnar shaft","Fractures and dislocations around the elbow in children","Fractures of the humeral shaft and elbow in adults","Dislocations and fracture dislocations of the elbow","Fractures around the shoulder","Dislocations of the shoulder region","Fractures of the ribs and sternum","Fractures of the pelvis","Femoral neck fractures","Femoral shaft fractures","Fractures of the tibial shaft","Fractures of the ankle","Fractures of the tarsus and foot","Injuries and the spinal radiograph","Spinal injuries","Acute haematogenous osteomyelitis","Chronic osteomyelitis","Septic arthritis","Peripheral nerve injuries","Brachial plexus injuries","Carpal tunnel syndrome","Ganglion","Bone tumours","Low back pain","The great toe","Arthroplasty","Useful reading","Suturing wounds","Skin grafts","Surgical aps","Management of scars","Excision of simple cutaneous lesions","Skin cancer","Burns: assessment","Burns: management","Soft tissue hand injuries","Hand infections","Dupuytrens disease","Breast reduction","Breast augmentation","Breast reconstruction","Basics","Principles of cardiac surgery","Coronary artery disease","Valvular heart disease","Cardiothoracic ICU","Lung cancer","Pleural effusion","Pneumothorax","Mediastinal disease","Acute limb ischaemia","Chronic upper limb ischaemia","Chronic lower limb ischaemia","Intermittent claudication","Critical limb ischaemia","Aneurysms","Ruptured abdominal aortic aneurysm","Vascular developmental abnormalities","Carotid disease","The diabetic foot","Amputations","Vasospastic disorders","Varicose veins","Deep venous thrombosis","Thrombolysis","Complications in vascular surgery","Basic transplant immunology","Immunosuppression and rejection","Transplant recipients","Transplant donors","Heart and lung transplantation","Kidney transplantation","Pancreas and islet transplantation","Liver transplantation","Small bowel transplantation","Medicine in the tropics","Typhoid","Amoebiasis and amoebic liver abscess","Anaemias in the tropics","Malaria","Filariasis","Hydatid disease","Ascariasis","Leishmaniasis","Trypanosomiasis","Tuberculosis in the tropics","Guinea worm infestation","Threadworms","Diagnostic laparoscopy","Principles of laparotomy","Cholecystectomy","Appendicectomy","Inguinal hernia repair","Perforated peptic ulcer repair","Haemorrhoid surgery","Femoral embolectomy","Right hemicolectomy","Stoma formation","Wide local excisionbreast","Below knee amputation","Anatomy and physiology key revision points index","Index","notes","disease","subcutaneous tissue disease","surgery","pill","thromboprophylaxis","antisepsis","procoagulants","complications","pulmonary embolism","ITU","support","Abdominal distension Symmetrical distension suggests one of the","Regime","active smokers or those who have stopped smoking within the last","CA","removable cast can be placed and the parents simply remove this in","Days","and recipient serology are given prophylactic valganciclovir for","Urinary leak often can be managed by urinary catheterization for"]
	end

	def self.get_contents(allergy_book_file_path_and_name,contents_file_path_and_name)
		titles = []
		## first manage the character conversion to utf 8.
		s = IO.read(allergy_book_file_path_and_name)
		s.force_encoding('UTF-8')
		s = s.encode('UTF-8', 'binary', invalid: :replace, undef: :replace, replace: '')
		s.split(/\r|\n|\t/).each do |line|
			
			line.scan(/^(?<title>[A-Za-z\s\:]+)\s\d+$/) do |title|
				unless EXCLUSIONS.include? title[0].strip.downcase
					titles << title
				end
			end
		end
		titles = titles.flatten.uniq.compact.map{|c| c.gsub(/\d+/,'').strip}
		puts titles.size
		IO.write(contents_file_path_and_name,JSON.generate(titles))
	end

	## here we have only a title processor, we don't go for subsections.
	def title_processor(line)
		section_name = nil
		
		line.strip.scan(/^(?<title>[A-Za-z\s\:]+)\s\d+$/) do |title|

			applicable_topics = topics.select{|c| title[0].strip == c}

			if applicable_topics.size > 0
				return ["on",clear_numbers_newlines_and_excess_spaces(title[0])]
			else
				return ["off",title[0]]
			end
		end
		return ["off",line]
	end


end